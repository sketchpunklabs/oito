<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title></title></head>
<style>canvas{ display:block; } body, html { padding:0px; margin:0px; width:100%; height:100%; }</style>
<body><script type="module">
//#region IMPORTS
import useThreeWebGL2, { useDarkScene, useVisualDebug } from '../_lib/useThreeWebGL2.js';

import { Colour } from '../../packages/core/src/index.ts';
//#endregion

//#region MAIN
let App   = useDarkScene( useThreeWebGL2() );
let Debug = {};
let Ref   = {};

window.addEventListener( 'load', async _=>{
    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    // Setup
    App.sphericalLook( 0, 20, 6 );
    Debug = await useVisualDebug( App );

    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    // Debug.pnt.add( [0,1,0], 0x00ff00, 7, 6 );

    
    const max = 15;
    
    const col = new Colour();
    for( let i=0; i < max; i++ ){
        col.fromHSV( i/max, 1, 1 );
        Debug.pnt.add( [i*0.2,2.5,0], col.toNumber(), 7, 6 );
    }
    
    for( let i=0; i < max; i++ ){
        col.fromHSL( i/max, 1.0, 0.5 );
        Debug.pnt.add( [i*0.2,1.8,0], col.toNumber(), 7, 6 );
    }

    for( let i=0; i < max; i++ ){
        col.fromHSL( i/max, 0.6, 0.7 );
        Debug.pnt.add( [i*0.2,1.6,0], col.toNumber(), 7, 6 );
    }

    for( let i=0; i < max; i++ ){
        const c = HSL2RGB( i/max, 1, 1 );
        Debug.pnt.add( [i*0.2,1,0], c, 7, 6 );
    }

    for( let i=0; i < max; i++ ){
        const c = HSL2RGB( i/max, 0.5, 0.7 );
        Debug.pnt.add( [i*0.2,0.8,0], c, 7, 6 );
    }
    

    for( let i=0; i < max; i++ ){
        const c = palette( i/max, pa );
        Debug.pnt.add( [i*0.2,0.5,0], c, 7, 6 );
    }

    for( let i=0; i < max; i++ ){
        col.fromPalettes( i/max, pb );
        Debug.pnt.add( [i*0.2,0.3,0], col.toNumber(), 7, 6 );
    }


    // console.log( 'x', rainbow( 30, 0 ) );
    // Debug.pnt.add( [0.1,1,0], rainbow( 30, 0 ), 7, 6 );
    
    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    App.renderLoop();
    // App.createRenderLoop( onPreRender ).start();
});

// function onPreRender( dt, et ){}
//#endregion

// all values are between 0 & 1, Hue, sat, light
function HSL2RGB( h, s, v ){
    const i = Math.floor(h * 6);
    const f = h * 6 - i;
    const p = v * (1 - s);
    const q = v * (1 - f * s);
    const t = v * (1 - (1 - f) * s);
    
    let r, g, b;
    switch (i % 6) {
        case 0: r = v, g = t, b = p; break;
        case 1: r = q, g = v, b = p; break;
        case 2: r = p, g = v, b = t; break;
        case 3: r = p, g = q, b = v; break;
        case 4: r = t, g = p, b = v; break;
        case 5: r = v, g = p, b = q; break;
    }

    const c = (~ ~(r * 255)) << 16 |
              (~ ~(g * 255)) << 8  |
              (~ ~(b * 255));


    // console.log( r, g, b );
    var x = "#" 
        + ("00" + (~ ~(r * 255)).toString(16)).slice(-2) 
        + ("00" + (~ ~(g * 255)).toString(16)).slice(-2) 
        + ("00" + (~ ~(b * 255)).toString(16)).slice(-2);


    // console.log( "#"+('000000' + c.toString( 16 )).substr( -6 ) );

    return c;
}

// https://stackoverflow.com/questions/1484506/random-color-generator
function rainbow(numOfSteps, step) {
    // This function generates vibrant, "evenly spaced" colours (i.e. no clustering). 
    // This is ideal for creating easily distinguishable vibrant markers in Google Maps and other apps.
    // Adam Cole, 2011-Sept-14
    // HSV to RBG adapted from: http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript
    var r, g, b;
    var h = step / numOfSteps;
    var i = ~~(h * 6);
    var f = h * 6 - i;
    var q = 1 - f;
    switch(i % 6){
        case 0: r = 1; g = f; b = 0; break;
        case 1: r = q; g = 1; b = 0; break;
        case 2: r = 0; g = 1; b = f; break;
        case 3: r = 0; g = q; b = 1; break;
        case 4: r = f; g = 0; b = 1; break;
        case 5: r = 1; g = 0; b = q; break;
    }

    console.log( r, g, b );
    console.log( 'meh',
        (~ ~(r * 255)) << 16 |
        (~ ~(g * 255)) << 8  |
        (~ ~(b * 255)) 
    )

    const c = (~ ~(r * 255)) << 16 |
              (~ ~(g * 255)) << 8  |
              (~ ~(b * 255)) 



    // console.log( r, g, b );
    var x = "#" 
        + ("00" + (~ ~(r * 255)).toString(16)).slice(-2) 
        + ("00" + (~ ~(g * 255)).toString(16)).slice(-2) 
        + ("00" + (~ ~(b * 255)).toString(16)).slice(-2);


    console.log( "#"+('000000' + c.toString( 16 )).substr( -6 ) );
    // return (c);

    return c;
}



// https://iquilezles.org/articles/palettes/

// cosine based palette, 4 vec3 params

// vec3(0.5,0.5,0.5),vec3(0.5,0.5,0.5),vec3(1.0,1.0,1.0),vec3(0.0,0.33,0.67)	

// vec3 col = pal( p.x, vec3(0.5,0.5,0.5),vec3(0.5,0.5,0.5),vec3(1.0,1.0,1.0),vec3(0.0,0.33,0.67) );
    //if( p.y>(1.0/7.0) ) col = pal( p.x, vec3(0.5,0.5,0.5),vec3(0.5,0.5,0.5),vec3(1.0,1.0,1.0),vec3(0.0,0.10,0.20) );
    //if( p.y>(2.0/7.0) ) col = pal( p.x, vec3(0.5,0.5,0.5),vec3(0.5,0.5,0.5),vec3(1.0,1.0,1.0),vec3(0.3,0.20,0.20) );
    //if( p.y>(3.0/7.0) ) col = pal( p.x, vec3(0.5,0.5,0.5),vec3(0.5,0.5,0.5),vec3(1.0,1.0,0.5),vec3(0.8,0.90,0.30) );
    //-if( p.y>(4.0/7.0) ) col = pal( p.x, vec3(0.5,0.5,0.5),vec3(0.5,0.5,0.5),vec3(1.0,0.7,0.4),vec3(0.0,0.15,0.20) );
    //--if( p.y>(5.0/7.0) ) col = pal( p.x, vec3(0.5,0.5,0.5),vec3(0.5,0.5,0.5),vec3(2.0,1.0,0.0),vec3(0.5,0.20,0.25) );
    // if( p.y>(6.0/7.0) ) col = pal( p.x, vec3(0.8,0.5,0.4),vec3(0.2,0.4,0.2),vec3(2.0,1.0,1.0),vec3(0.0,0.25,0.25) );
    
//function palette( t, a=[0.5,0.5,0.5], b=[0.5, 0.5, 0.5], c=[1.0, 1.0, 1.0], d=[0.00, 0.33, 0.67] ){
function palette( t, p ){
    const rr = p.a[0] + p.b[0] * Math.cos( 6.28318 * ( p.c[0] * t + p.d[0] ) );
    const gg = p.a[1] + p.b[1] * Math.cos( 6.28318 * ( p.c[1] * t + p.d[1] ) );
    const bb = p.a[2] + p.b[2] * Math.cos( 6.28318 * ( p.c[2] * t + p.d[2] ) );

    console.log( rr, gg, bb );

    const cc = (~ ~(rr * 255)) << 16 |
              (~ ~(gg * 255)) << 8  |
              (~ ~(bb * 255));
    return cc;
}

const pa = {
    a:[0.5,0.5,0.5], 
    b:[0.5, 0.5, 0.5], 
    c:[1.0, 1.0, 1.0], 
    d:[0.00, 0.33, 0.67],
}

const pb = {
    a:[0.5,0.5,0.5],
    b:[0.5,0.5,0.5],
    c:[2.0,1.0,0.0],
    d:[0.5,0.20,0.25]
}


</script></body></html>